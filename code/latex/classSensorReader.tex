\hypertarget{classSensorReader}{}\doxysection{Sensor\+Reader Class Reference}
\label{classSensorReader}\index{SensorReader@{SensorReader}}


{\ttfamily \#include $<$Sensor\+Reader.\+hpp$>$}

Inheritance diagram for Sensor\+Reader\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classSensorReader}
\end{center}
\end{figure}
\doxysubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classSensorReader_a6745a565b7f71eff935165ea8359f38c}\label{classSensorReader_a6745a565b7f71eff935165ea8359f38c}} 
enum \{ {\bfseries I\+D\+\_\+\+R\+E\+A\+D\+\_\+\+I\+ND}, 
{\bfseries I\+D\+\_\+\+I\+D\+E\+N\+T\+I\+F\+Y\+\_\+\+I\+ND}
 \}
\begin{DoxyCompactList}\small\item\em Event message ID\textquotesingle{}s. Used to cast wrapper structs. They are received as their base-\/class Message and therefore need to be identified and casted. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classSensorReader_a639d876b26cc84413f5ff092dc7a3f45}\label{classSensorReader_a639d876b26cc84413f5ff092dc7a3f45}} 
\mbox{\hyperlink{classSensorReader_a639d876b26cc84413f5ff092dc7a3f45}{Sensor\+Reader}} (\mbox{\hyperlink{classCoinIdentifier}{Coin\+Identifier}} $\ast$identifier)
\begin{DoxyCompactList}\small\item\em Constructor. Parameter is the identifier that will receive the time signature captures from \mbox{\hyperlink{classSensorReader}{Sensor\+Reader}}. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSensorReader_a0e493b0e27ba3f3c4ffaf76ec5d253ae}\label{classSensorReader_a0e493b0e27ba3f3c4ffaf76ec5d253ae}} 
\mbox{\hyperlink{classosapi_1_1BasicMsgQueue}{osapi\+::\+Msg\+Queue}} $\ast$ \mbox{\hyperlink{classSensorReader_a0e493b0e27ba3f3c4ffaf76ec5d253ae}{get\+Msg\+Queue}} ()
\begin{DoxyCompactList}\small\item\em Returns message queue of the class. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classSensorReader_a0d96f1b0b532e468b5bec8a08baf5c70}\label{classSensorReader_a0d96f1b0b532e468b5bec8a08baf5c70}} 
static const int \mbox{\hyperlink{classSensorReader_a0d96f1b0b532e468b5bec8a08baf5c70}{M\+A\+X\+\_\+\+Q\+U\+E\+U\+E\+\_\+\+S\+I\+ZE}} = 64
\begin{DoxyCompactList}\small\item\em Message queue size. Sending on a full queue will block sender to keep synchronized. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classSensorReader_a23ed6518af32a6ddaf062767f36e612a}{run}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classSensorReader_abfd6546a9e7d2f5ac3405ccae9be1441}\label{classSensorReader_abfd6546a9e7d2f5ac3405ccae9be1441}} 
void \mbox{\hyperlink{classSensorReader_abfd6546a9e7d2f5ac3405ccae9be1441}{sensor\+Reader\+Handler}} (unsigned int id, \mbox{\hyperlink{classosapi_1_1Message}{osapi\+::\+Message}} $\ast$msg)
\begin{DoxyCompactList}\small\item\em Indentifies messages on received on \mbox{\hyperlink{classSensorReader}{Sensor\+Reader}}\textquotesingle{}s message queue, casts the message if needed and starts the correct handler function. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSensorReader_ad50d7a03d46b8a9b8b6a69d1704bc797}\label{classSensorReader_ad50d7a03d46b8a9b8b6a69d1704bc797}} 
void \mbox{\hyperlink{classSensorReader_ad50d7a03d46b8a9b8b6a69d1704bc797}{sensor\+Reader\+Handle\+Read}} ()
\begin{DoxyCompactList}\small\item\em Reads from /dev/\+C\+DS file which is the sensor character drivers node. Reading from the file returns time signatures as coins pass by the sensors. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSensorReader_a4794e2c710f6f39c44562e4e413f2afd}\label{classSensorReader_a4794e2c710f6f39c44562e4e413f2afd}} 
void \mbox{\hyperlink{classSensorReader_a4794e2c710f6f39c44562e4e413f2afd}{extract\+Times}} (std\+::string line, std\+::string delimiter, \mbox{\hyperlink{structCoinTimings}{Coin\+Timings}} $\ast$timings)
\begin{DoxyCompactList}\small\item\em Turns the string from read from the C\+D\+S-\/driver into captured timings in the specified \mbox{\hyperlink{structCoinTimings}{Coin\+Timings}} struct. The delimiter is the seperator of the two time values read from the driver. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classSensorReader_a108399193faacafcd594f88219313bb9}\label{classSensorReader_a108399193faacafcd594f88219313bb9}} 
bool \mbox{\hyperlink{classSensorReader_a108399193faacafcd594f88219313bb9}{running\+\_\+}}
\begin{DoxyCompactList}\small\item\em Event loop exit if set to false. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSensorReader_a018e114544e7105b049b25a5e77cf69d}\label{classSensorReader_a018e114544e7105b049b25a5e77cf69d}} 
\mbox{\hyperlink{classosapi_1_1BasicMsgQueue}{osapi\+::\+Msg\+Queue}} \mbox{\hyperlink{classSensorReader_a018e114544e7105b049b25a5e77cf69d}{mq\+\_\+}}
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{classSensorReader}{Sensor\+Reader}}\textquotesingle{}s F\+I\+FO message queue where received events are stored. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSensorReader_a421be37e19c468ca3da02d5ea30e8ff4}\label{classSensorReader_a421be37e19c468ca3da02d5ea30e8ff4}} 
std\+::string \mbox{\hyperlink{classSensorReader_a421be37e19c468ca3da02d5ea30e8ff4}{delimiter\+\_\+}} = \char`\"{},\char`\"{}
\begin{DoxyCompactList}\small\item\em Seperator between the time values read from the C\+D\+S-\/driver file. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSensorReader_aedf6dd3455da40a556738a42c07c67df}\label{classSensorReader_aedf6dd3455da40a556738a42c07c67df}} 
std\+::string \mbox{\hyperlink{classSensorReader_aedf6dd3455da40a556738a42c07c67df}{linereading\+\_\+}}
\begin{DoxyCompactList}\small\item\em Line read from the C\+D\+S-\/driver file. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSensorReader_a97da157cd4897d1c8c6af0f4b4a590d1}\label{classSensorReader_a97da157cd4897d1c8c6af0f4b4a590d1}} 
\mbox{\hyperlink{classCoinIdentifier}{Coin\+Identifier}} $\ast$ \mbox{\hyperlink{classSensorReader_a97da157cd4897d1c8c6af0f4b4a590d1}{identifier\+\_\+}}
\begin{DoxyCompactList}\small\item\em Receiver of the timing indication events, which will turn the time signatures into coin values. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Reads from the kernel character driver file at /dev/\+C\+DS to catch coin time signatures. Signatures are read as comma seperated values, then they are extracted and sent to a \mbox{\hyperlink{classCoinIdentifier}{Coin\+Identifier}}. The class inherits from O\+S\+A\+PI Thread\+Functor class to enable starting the c++ class as a thread using P\+O\+S\+I\+X-\/threads. 

Definition at line 18 of file Sensor\+Reader.\+hpp.



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classSensorReader_a23ed6518af32a6ddaf062767f36e612a}\label{classSensorReader_a23ed6518af32a6ddaf062767f36e612a}} 
\index{SensorReader@{SensorReader}!run@{run}}
\index{run@{run}!SensorReader@{SensorReader}}
\doxysubsubsection{\texorpdfstring{run()}{run()}}
{\footnotesize\ttfamily void Sensor\+Reader\+::run (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}

Event loop. Receives messages from the message queue, calls the handler, then deletes the message. Is inherited from the Thread\+Functor class and overwritten. 

Implements \mbox{\hyperlink{classosapi_1_1ThreadFunctor}{osapi\+::\+Thread\+Functor}}.



Definition at line 13 of file Sensor\+Reader.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{14 \{}
\DoxyCodeLine{15   std::cout << \textcolor{stringliteral}{"Event loop in SensorReader started running!"} << std::endl;}
\DoxyCodeLine{16   \textcolor{keywordflow}{while} (\mbox{\hyperlink{classSensorReader_a108399193faacafcd594f88219313bb9}{running\_}})}
\DoxyCodeLine{17   \{}
\DoxyCodeLine{18     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} id;}
\DoxyCodeLine{19     \mbox{\hyperlink{classosapi_1_1Message}{osapi::Message}} *  msg = \mbox{\hyperlink{classSensorReader_a018e114544e7105b049b25a5e77cf69d}{mq\_}}.receive(\textcolor{keywordtype}{id});}
\DoxyCodeLine{20     \mbox{\hyperlink{classSensorReader_abfd6546a9e7d2f5ac3405ccae9be1441}{sensorReaderHandler}}(\textcolor{keywordtype}{id}, msg);}
\DoxyCodeLine{21     \textcolor{keyword}{delete} msg;}
\DoxyCodeLine{22   \}}
\DoxyCodeLine{23 \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
Coin\+Detecting\+Sensors/\+O\+S\+Api\+Student/\+C\+D\+S/Sensor\+Reader.\+hpp\item 
Coin\+Detecting\+Sensors/\+O\+S\+Api\+Student/\+C\+D\+S/Sensor\+Reader.\+cpp\end{DoxyCompactItemize}
